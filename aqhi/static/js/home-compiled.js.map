{"version":3,"sources":["home.js"],"names":[],"mappings":"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","file":"home-compiled.js","sourcesContent":["\"use strict\";\n\nmoment.locale('zh-cn');\n\nvar CountdownLatch = function(limit) {\n  this.limit = limit;\n  this.count = 0;\n  this.waitBlock = function (){};\n};\nCountdownLatch.prototype.countDown = function() {\n  this.count = this.count + 1;\n  if(this.limit <= this.count) {\n    return this.waitBlock();\n  }\n};\nCountdownLatch.prototype.await = function(callback) {\n  this.waitBlock = callback;\n};\n\nvar qualityTexts = {\n  E: {cls: 'qlty-excellent', text: '优'},\n  G: {cls: 'qlty-good', text: '良'},\n  LP: {cls: 'qlty-lightly', text: '轻度污染'},\n  MP: {cls: 'qlty-moderately', text: '中度污染'},\n  HP: {cls: 'qlty-heavily', text: '重度污染'},\n  SP: {cls: 'qlty-severely', text: '严重污染'}\n};\n\nvar aqhiRange = [4, 7, 8, 11];\nvar aqhiTexts = {\n  0: {cls: 'aqhi-low', text: '低'},\n  1: {cls: 'aqhi-moderate', text: '中'},\n  2: {cls: 'aqhi-high', text: '高'},\n  3: {cls: 'aqhi-very-high', text: '较高'},\n  4: {cls: 'aqhi-serious', text: '严重'}\n};\nvar aqhiAdviceTextEles = {\n  0: $(`\n    <p class=\"card-text\">\n      所有人员均可正常活动。\n    </p>\n  `),\n  1: $(`\n    <p class=\"card-text\">\n      <span class=\"people-class\">心脏病或呼吸系统疾病患者</span>\n      <br>应<strong>考虑减少</strong>户外体力消耗。\n    </p>\n  `),\n  2: $(`\n    <p class=\"card-text\">\n      <span class=\"people-class\">心脏病或呼吸系统疾病患者</span>\n      <span class=\"people-class\">儿童及老人</span>\n      <br>应<strong>减少</strong>户外体力消耗和户外逗留时间。\n    </p>\n  `),\n  3: $(`\n    <p class=\"card-text\">\n      <span class=\"people-class\">心脏病或呼吸系统疾病患者</span>\n      <span class=\"people-class\">儿童及老人</span>\n      <br>应<strong>尽量减少</strong>户外体力消耗和户外逗留时间。\n    </p>\n    <p class=\"card-text\">\n      <span class=\"people-class\">户外工作人员</span>\n      <span class=\"people-class\">一般市民</span>\n      <br>应<strong>减少</strong>户外体力消耗和户外逗留时间。\n    </p>\n  `),\n  4: $(`\n    <p class=\"card-text\">\n      <span class=\"people-class\">心脏病或呼吸系统疾病患者</span>\n      <span class=\"people-class\">儿童及老人</span>\n      <br>应<strong>避免</strong>户外体力消耗和户外逗留。\n    </p>\n    <p class=\"card-text\">\n      <span class=\"people-class\">户外工作人员</span>\n      <span class=\"people-class\">一般市民</span>\n      <br>应<strong>尽量减少</strong>户外体力消耗和户外逗留时间。\n    </p>\n  `)\n};\n\nvar pollutantNames = ['co', 'so2', 'o3', 'o3_8h', 'pm10', 'pm2_5', 'no2'];\nvar pollutantAndAqiNames = ['aqi', 'aqhi'].concat(pollutantNames);\nvar pollutantAndAqiProperties = {\n  co: {maxValue: 5, color: 'f4e781', label: 'CO'},\n  so2: {maxValue: 50, color: 'bda29a', label: 'SO2'},\n  o3: {maxValue: 400, color: 'd48265', label: 'O3'},\n  o3_8h: {maxValue: 400, color: '91c7aE', label: 'O3/8h'},\n  pm10: {maxValue: 300, color: '749f83', label: 'PM10'},\n  pm2_5: {maxValue: 500, color: 'ca8622', label: 'PM2.5'},\n  no2: {maxValue: 100, color: '61a0a8', label: 'NO2'},\n  aqi: {maxValue: 500, color: 'c23531', label: 'AQI'},\n  aqhi: {maxValue: 12, color: 'cf2abf', label: 'AQHI'}\n};\n\nvar primaryPollutantTexts = pollutantNames.reduce(function(prev, name) {\n  var text = pollutantAndAqiProperties[name].label;\n  prev[name] = {cls: 'pol-' + name, text: text};\n  return prev;\n}, Object.create(null));\nprimaryPollutantTexts['NA'] = {cls: '', text: '无'};\n\n\n// weather icon class names\nvar weatherIconClassNames = {\n  100: { day: \"wi-day-sunny\", night: \"wi-night-clear\"}, \n  101: { day: \"wi-cloudy\", night: \"wi-cloudy\"}, \n  102: { day: \"wi-cloud\", night: \"wi-cloud\"}, \n  103: { day: \"wi-day-cloudy\", night: \"wi-night-cloudy\"}, \n  104: { day: \"wi-day-sunny-overcast\", night: \"wi-night-partly-cloudy\"}, \n  200: { day: \"wi-day-windy\", night: \"wi-windy\"}, \n  202: { day: \"wi-day-windy\", night: \"wi-windy\"}, \n  203: { day: \"wi-day-windy\", night: \"wi-windy\"}, \n  204: { day: \"wi-day-windy\", night: \"wi-windy\"}, \n  205: { day: \"wi-strong-wind\", night: \"wi-strong-wind\"}, \n  206: { day: \"wi-strong-wind\", night: \"wi-strong-wind\"}, \n  207: { day: \"wi-strong-wind\", night: \"wi-strong-wind\"}, \n  208: { day: \"wi-strong-wind\", night: \"wi-strong-wind\"}, \n  209: { day: \"wi-day-thunderstorm\", night: \"wi-night-thunderstorm\"}, \n  210: { day: \"wi-day-thunderstorm\", night: \"wi-night-thunderstorm\"}, \n  211: { day: \"wi-hurricane\", night: \"wi-hurricane\"}, \n  212: { day: \"wi-tornado\", night: \"wi-tornado\"}, \n  213: { day: \"wi-hurricane\", night: \"wi-hurricane\"}, \n  300: { day: \"wi-day-rain\", night: \"wi-night-rain\"}, \n  301: { day: \"wi-day-showers\", night: \"wi-night-showers\"}, \n  302: { day: \"wi-day-storm-showers\", night: \"wi-night-storm-showers\"}, \n  303: { day: \"wi-day-thunderstorm\", night: \"wi-night-thunderstorm\"}, \n  304: { day: \"wi-day-hail\", night: \"wi-night-hail\"}, \n  305: { day: \"wi-day-rain\", night: \"wi-night-rain\"}, \n  306: { day: \"wi-day-rain\", night: \"wi-night-rain\"}, \n  307: { day: \"wi-day-rain\", night: \"wi-night-rain\"}, \n  308: { day: \"wi-day-rain\", night: \"wi-night-rain\"}, \n  309: { day: \"wi-day-sprinkle\", night: \"wi-night-sprinkle\"}, \n  310: { day: \"wi-day-thunderstorm\", night: \"wi-night-thunderstorm\"}, \n  311: { day: \"wi-day-thunderstorm\", night: \"wi-night-thunderstorm\"}, \n  312: { day: \"wi-day-thunderstorm\", night: \"wi-night-thunderstorm\"}, \n  313: { day: \"wi-day-rain-mix\", night: \"wi-night-rain-mix\"}, \n  400: { day: \"wi-day-snow\", night: \"wi-night-snow\"}, \n  401: { day: \"wi-day-snow\", night: \"wi-night-snow\"}, \n  402: { day: \"wi-day-snow\", night: \"wi-night-snow\"}, \n  403: { day: \"wi-day-snow\", night: \"wi-night-snow\"}, \n  404: { day: \"wi-day-sleet\", night: \"wi-night-sleet\"}, \n  405: { day: \"wi-day-sleet\", night: \"wi-night-sleet\"}, \n  406: { day: \"wi-day-sleet\", night: \"wi-night-sleet\"}, \n  407: { day: \"wi-day-snow\", night: \"wi-night-snow\"}, \n  500: { day: \"wi-day-fog\", night: \"wi-night-fog\"}, \n  501: { day: \"wi-day-fog\", night: \"wi-night-fog\"}, \n  502: { day: \"wi-day-haze\", night: \"wi-dust\"}, \n  503: { day: \"wi-dust\", night: \"wi-dust\"}, \n  504: { day: \"wi-dust\", night: \"wi-dust\"}, \n  506: { day: \"wi-volcano\", night: \"wi-volcano\"}, \n  507: { day: \"wi-sandstorm\", night: \"wi-sandstorm\"}, \n  508: { day: \"wi-sandstorm\", night: \"wi-sandstorm\"}, \n  900: { day: \"wi-thermometer\", night: \"wi-thermometer\"}, \n  901: { day: \"wi-thermometer-exterior\", night: \"wi-thermometer-exterior\"}, \n  999: { day: \"wi-na\", night: \"wi-na\"}\n};\n\nvar zhWeekDays = {\n  1: '一',\n  2: '二',\n  3: '三',\n  4: '四',\n  5: '五',\n  6: '六',\n  7: '日'\n};\n\n$(function() {\n  // Helper functions\n  var toggleIcon = function(iconEle, collapse) {\n    iconEle.each(function (i, e) {\n      e = $(e);\n      if (!collapse || (collapse == undefined && e.hasClass('icon-rotate-180')))\n        e.removeClass('icon-rotate-180');\n      else if (collapse || (collapse == undefined && !e.hasClass('icon-rotate-180')))\n        e.addClass('icon-rotate-180');\n    });\n  };\n\n  // City accordion\n  var cityAccordion = $('#city-accordion');\n\n  // Style changes on collapsed\n  cityAccordion.on('show.bs.collapse', '.panel-collapse', function() {\n    // After one is going to show, change panel heading's style\n    $(this).closest('.city-panel').find('.city-panel-heading').removeClass('collapsed');\n  });\n  cityAccordion.on('hidden.bs.collapse', '.panel-collapse', function() {\n    // After one is hidden\n    // Change panel heading's style\n    $(this).closest('.city-panel').find('.city-panel-heading').addClass('collapsed');\n  });\n  cityAccordion.on('shown.bs.collapse', '.panel-collapse', function() {\n    // After one is shown, follow the transition to the city title\n    var panelCollapse = $(this);\n    if (panelCollapse.hasClass('collapse') && panelCollapse.hasClass('in')) {\n      var target = panelCollapse.closest('.city-panel').find('.city-title-link');\n      $('html, body').stop().animate({\n        scrollTop: target.offset().top - 70\n      }, 500, 'swing');\n    }\n  });\n\n  cityAccordion.on('click', '.panel-heading a', function(event) {\n    var body_ele = $($(this).attr('href'));\n    var cityName = $(this).closest('.city-panel').data('city');\n    if (body_ele.children().length == 0) {\n      event.stopPropagation();\n\n      $.get('api/core/city_panel_body', {\n          city_en: cityName\n      }).done(function(response) {\n        body_ele.html(response);\n        body_ele.collapse({\n          parent: '#city-accordion'\n        });\n\n        initCity(cityName, body_ele.closest('.city-panel'));\n      });\n    }\n\n    // Toggle collapse icon\n    if (body_ele.hasClass('collapse')) {\n      if (body_ele.hasClass('in'))\n        toggleIcon($(this).find('.icon-collapse'), true);\n      else {\n        toggleIcon($(this).find('.icon-collapse'), false);\n        toggleIcon($(this).closest('.panel').siblings().find('.icon-collapse'), true);\n      }\n    } else if (body_ele.hasClass('collapsing'))\n      toggleIcon($(this).find('.icon-collapse'), true);\n\n  });\n\n  var primaryCityPanel = $('.city-panel.primary-city-panel');\n  var primaryCityName = primaryCityPanel.data('city');\n  // Init primary city\n  initCity(primaryCityName, primaryCityPanel)\n});\n\nfunction initCity(cityName, cityPanel) {\n  $.getJSON('api/airquality/latest_city_record', {\n    city: cityName\n  }).done(function(latestCityRecord) {\n    initRankChart(latestCityRecord.update_dtm);\n    initCityAirCondition(latestCityRecord, cityPanel.find('.air-condition-card'));\n    initCityWeather(latestCityRecord, cityPanel);\n    initStationsMap(latestCityRecord, cityPanel);\n    initCityHistoryChart(latestCityRecord, cityPanel);\n  });\n}\n\nfunction initStationsMap(cityRecord, cityPanel) {\n  var option = {\n    backgroundColor: '#404a59',\n    tooltip: {\n      formatter: function(params) {\n        return params.name + \"：\" + params.value[2];\n      }\n    },\n    legend: {\n      orient: 'vertical',\n      data: [],\n      top: 'bottom',\n      left: 'right',\n      textStyle: {\n        color: '#fff'\n      },\n      selectedMode: 'single'\n    },\n    visualMap: {\n      type: 'continuous',\n      min: 0,\n      max: 500,\n      text: ['High', 'Low'],\n      inRange: {\n        color: ['lightskyblue','yellow','orangered']\n      },\n      textStyle: {\n        color: '#fff'\n      }\n    },\n    geo: {\n      map: '',\n      roam: true,\n      itemStyle: {\n        normal: {\n          color: '#323c48',\n          borderColor: '#111'\n        },\n        emphasis: {\n          color: '#2a333d'\n        }\n      },\n      label: {\n        normal: { show: false },\n        emphasis: {\n          show: true,\n          textStyle: { color: '#fff'}\n        }\n      },\n      top: 'top',\n      left: 'center'\n    },\n    series: []\n  };\n\n  var cityName = cityRecord.city.name_en;\n  var chartEle = $(`#map-${cityName}`);\n  var myChart = echarts.init(chartEle[0]);\n  setChartSize(myChart, 0.6);\n\n  registerEchartResizeFuncton(myChart);\n\n  // load data\n  var loadingLatch = new CountdownLatch(2);\n  // load map geo data\n  $.getJSON('static/geo/' + cityName + '.json', function (geoData) {\n    echarts.registerMap(cityName, geoData);\n    loadingLatch.countDown();\n  });\n  // load map air quality data\n  var qualityData;\n  $.getJSON('api/airquality/station_record', {\n    city_record: cityRecord.id\n  }).done(function(data) {\n    qualityData = data.results;\n    loadingLatch.countDown();\n  });\n\n  loadingLatch.await(function() {\n    pollutantAndAqiNames.forEach(function(pollutantName) {\n      var label = pollutantAndAqiProperties[pollutantName].label;\n\n      option.legend.data.push(label);\n      var valueArray = qualityData.map(function (data) {\n        return parsePollutantOrAqiValue(pollutantName, data[pollutantName]);\n      });\n\n      option.geo.map = cityName;\n      var seriesData = {\n        type: 'scatter',\n        name: label,\n        coordinateSystem: 'geo',\n        itemStyle: {\n          emphasis: {\n            borderColor: '#fff',\n              borderWidth: 1\n          }\n        },\n        data: []\n      };\n\n      seriesData.data = valueArray.map(function(value, i) {\n        var station = qualityData[i].station;\n        return {\n          name: station.name_cn,\n          value: [station.longitude, station.latitude, value]\n        }\n      });\n      var maxVal = valueArray.reduce(function(max, val) {\n        return isNaN(val) ? max : Math.max(val, max)\n      }, valueArray.find(function(v) { return !isNaN(v) }));\n      var minVal = valueArray.reduce(function(min, val) {\n        return isNaN(val) ? min : Math.min(val, min)\n      }, valueArray.find(function(v) { return !isNaN(v) }));\n      var ratio = (maxVal - minVal) / (100 - 20);\n      var diff = minVal / ratio - 20;\n      seriesData.symbolSize = function(val) {\n        return val[2] / ratio - diff;\n      };\n      option.series.push(seriesData);\n    });\n    myChart.setOption(option);\n    myChart.resize();\n    hideLoading(chartEle.closest('.card-content'));\n  });\n\n}\n\nfunction initCityHistoryChart(cityRecord, cityPanel) {\n  var option = {\n    backgroundColor: '#404a59',\n    tooltip : {\n      trigger: 'axis'\n    },\n    legend: {\n      data:[], //Legend names\n      selectedMode: 'single'\n    },\n    toolbox: {\n      feature: {\n        saveAsImage: {}\n      }\n    },\n    grid: {\n      left: '3%',\n      right: '4%',\n      bottom: '8%',\n      containLabel: true\n    },\n    xAxis: [\n      {\n        type : 'category',\n        boundaryGap : false,\n        data : [], // hour names\n        axisLabel: {textStyle: {color: '#fff'}},\n        axisLine: {lineStyle: {color: '#fff'}},\n        splitLine: {show: false}\n      }\n    ],\n    yAxis: [\n      {\n        type : 'value',\n        axisLine: {lineStyle: {color: '#fff'}},\n        axisLabel: {textStyle: {color: '#fff'}}\n      }\n    ],\n    dataZoom: [\n      {\n        type: 'inside',\n        xAxisIndex: [0],\n        start: 50,\n        end: 100,\n        zoomLock: true\n      },\n      {\n        type: 'slider',\n        xAxisIndex: [0],\n        start: 50,\n        end: 100,\n        zoomLock: true\n      }\n    ],\n    series : []\n  };\n\n  var seriesDataTemplate = {\n    name:'',\n    type:'line',\n    areaStyle: {normal: {}},\n    label: {\n      normal: {\n        show: true,\n        position: 'top'\n      }\n    }\n    // data = []\n  };\n\n  var cityName = cityRecord.city.name_en;\n  var chartEle = $(`#history-chart-${cityName}`);\n  var chart = echarts.init(chartEle[0]);\n  setChartSize(chart, 0.6);\n\n  registerEchartResizeFuncton(chart);\n\n  var pollutantAndAqiSeriesData = pollutantAndAqiNames.reduce(function(obj, name) {\n    var datum = Object.assign({}, seriesDataTemplate);\n    datum.data = [];\n    var label = pollutantAndAqiProperties[name].label;\n    option.legend.data.push(label);\n    datum.name = label;\n    option.series.push(datum);\n\n    obj[name] = datum;\n    return obj;\n  }, Object.create(null));\n  var now = moment.utc(cityRecord.update_dtm);\n  var startDtm = now.clone().subtract(1, 'days');\n  var endDtm = now.clone();\n  $.getJSON('api/airquality/city_record', {\n    city: cityName,\n    start_dtm: startDtm.format(),\n    end_dtm: endDtm.format(),\n    limit: 30,\n    ordering: '-update_dtm'\n  }).done(function(data) {\n    var records = data.results;\n\n    for (var curDtm = startDtm.clone(); curDtm <= endDtm; curDtm.add(1, 'hours')) {\n      option.xAxis[0].data.push(\n        curDtm.isSame(endDtm) ?\n          \"现在\" :\n          `${curDtm.hours()}时`\n      );\n      var curRecord = records.find(function(ele) { return moment(ele.update_dtm).isSame(curDtm)});\n      if (curRecord == undefined) {\n        curRecord = pollutantAndAqiNames.reduce(function(rec, name) {\n          rec[name] = '';\n          return rec;\n        }, Object.create(null));\n      }\n\n      pollutantAndAqiNames.forEach(function(name) {\n        var value = parsePollutantOrAqiValue(name, curRecord[name]);\n        if (isNaN(value)) value = '-';\n        pollutantAndAqiSeriesData[name].data.push(value);\n      })\n    }\n    chart.setOption(option);\n    chart.resize();\n    hideLoading(chartEle.closest('.card-content'));\n  });\n\n\n}\n\nfunction initCityAirCondition(cityRecord, cityAirCard) {\n  var record = cityRecord;\n\n  var qualityEle = cityAirCard.find('.quality-level');\n  var aqhiLevelEle = cityAirCard.find('.aqhi-level');\n  var aqhiHeadEle = cityAirCard.find('.aqhi-head');\n  var primaryPolListEle = cityAirCard.find('.primary-pollutant-list');\n  var polDataEles = pollutantNames.reduce(function(prev, name) {\n    prev[name] = cityAirCard.find('.pollutant-data.pol-' + name);\n    return prev;\n  }, Object.create(null));\n  \n  if (record.aqhi == 11) {\n    aqhiHeadEle.addClass('aqhi-head-small');\n  } else {\n    aqhiHeadEle.removeClass('aqhi-head-small');\n  }\n  aqhiHeadEle.html(getAqhiHtml(record.aqhi));\n  cityAirCard.find('.aqi-head').text(parseInt(record.aqi));\n  qualityEle.addClass(qualityTexts[record.quality].cls);\n  qualityEle.html(qualityTexts[record.quality].text);\n  var aqhiLevel = getAqhiLevel(record.aqhi);\n  aqhiLevelEle.addClass(aqhiTexts[aqhiLevel].cls);\n  aqhiLevelEle.html(aqhiTexts[aqhiLevel].text);\n  cityAirCard.find('.people-advice-text').html(aqhiAdviceTextEles[aqhiLevel]);\n  cityAirCard.find('.air-condition-update-time-data').text(moment(record.update_dtm).fromNow());\n\n  var primaryPollutants = record.primary_pollutants;\n  if (record.primary_pollutants.length == 0)\n    primaryPollutants.push({pollutant: 'NA'});\n  primaryPollutants.forEach(function(pol) {\n    var name = pol.pollutant;\n    $('<li></li>')\n      .addClass(primaryPollutantTexts[name].cls)\n      .html(primaryPollutantTexts[name].text)\n      .appendTo(primaryPolListEle);\n  });\n\n\n  pollutantNames.forEach(function(name) {\n    var valueString = record[name];\n    if (valueString == '')\n      polDataEles[name].text('——');\n    else\n      polDataEles[name].text(Number(valueString));\n  });\n\n  hideLoading(cityAirCard.find('.card-content'));\n}\n\nfunction initCityWeather(cityRecord, cityPanel) {\n  var resizeHourlyForecastList = function() {\n    cityPanel.find('.hourly-weather-list').width(cityPanel.find('.air-condition-card .card-header').width() - 3);\n  };\n  $(window).resize(resizeHourlyForecastList);\n  // test\n  $.getJSON(`static/weather/test-${cityRecord.city.name_en}.json`).done(function(jsonData) {\n    var weatherData = jsonData['HeWeather data service 3.0'][0];\n    var todayWeatherData = weatherData.daily_forecast[0];\n\n    var updateTimes = weatherData.basic.update;\n    var localUtcOffset = moment(updateTimes.loc).diff(moment(updateTimes.utc), 'hours');\n    var now = moment.utc(updateTimes.utc); // the update time, not user time\n    var isDay = (function() {\n      var locTime = moment.duration(moment(updateTimes.loc).format('HH:mm')).as('minutes');\n      var astroTimes = todayWeatherData.astro;\n      var sunriseTime = moment.duration(astroTimes.sr).as('minutes');\n      var sunsetTime = moment.duration(astroTimes.ss).as('minutes');\n\n      return !!(locTime >= sunriseTime && locTime <= sunsetTime);\n    })();\n\n    var nowWeatherData = weatherData.now;\n    var curWeatherIcon = cityPanel.find('.cur-weather-block i');\n    cityPanel.find('.weather-update-time-data').text(now.fromNow());\n    cityPanel.find('.today-weather-weekday-text').text(`周${zhWeekDays[now.isoWeekday()]}`);\n    cityPanel.find('.today-max-temp').text(todayWeatherData.tmp.max);\n    cityPanel.find('.today-min-temp').text(todayWeatherData.tmp.min);\n    cityPanel.find('.temp-head-data').text(nowWeatherData.tmp);\n    cityPanel.find('.cur-weather-text').text(nowWeatherData.cond.txt);\n\n    // Current weather Icon\n    curWeatherIcon.removeClass().addClass(\n      `wi ${weatherIconClassNames[nowWeatherData.cond.code][isDay ? 'day' : 'night']}`\n    );\n\n    // Next day weather\n    var tomorrowWeatherData = weatherData.daily_forecast[1];\n    var nextDayWeatherFirstRow = cityPanel.find('.next-day-weather-col').first();\n    var nextDayWeatherSecondRow = nextDayWeatherFirstRow.next();\n\n    var headerTxt, headerClass, weatherTxt, weatherIconClass;\n    if (isDay) {\n      headerTxt = '今天白天';\n      headerClass = 'day';\n      weatherTxt = todayWeatherData.cond.txt_d;\n      weatherIconClass = weatherIconClassNames[todayWeatherData.cond.code_d].day;\n    } else {\n      headerTxt = '今天夜间';\n      headerClass = 'night';\n      weatherTxt = todayWeatherData.cond.txt_n;\n      weatherIconClass = weatherIconClassNames[todayWeatherData.cond.code_n].night;\n    }\n    nextDayWeatherFirstRow.find('.next-day-weather-header').text(headerTxt).removeClass(['day', 'night']).addClass(headerClass);\n    nextDayWeatherFirstRow.find('.next-day-weather-text').text(weatherTxt);\n    nextDayWeatherFirstRow.find('i').removeClass().addClass(`wi ${weatherIconClass}`);\n\n    if (isDay) {\n      headerTxt = '今天夜间';\n      headerClass = 'night';\n      weatherTxt = todayWeatherData.cond.txt_n;\n      weatherIconClass = weatherIconClassNames[todayWeatherData.cond.code_n].night;\n    } else {\n      headerTxt = '明天白天';\n      headerClass = 'day';\n      weatherTxt = tomorrowWeatherData.cond.txt_d;\n      weatherIconClass = weatherIconClassNames[tomorrowWeatherData.cond.code_d].day;\n    }\n    nextDayWeatherSecondRow.find('.next-day-weather-header').html(headerTxt).removeClass(['day', 'night']).addClass(headerClass);\n    nextDayWeatherSecondRow.find('.next-day-weather-text').html(weatherTxt);\n    nextDayWeatherSecondRow.find('i').removeClass().addClass(`wi ${weatherIconClass}`);\n\n    var hourlyForecasts = weatherData.hourly_forecast;\n    var hourlyForecastList = cityPanel.find('.hourly-weather-list');\n    // Add now temp first\n    hourlyForecastList.empty().append(getNewHourlyWeatherListItem(\n      '<strong>现在</strong>',\n      nowWeatherData.tmp\n    ));\n    hourlyForecasts.forEach(function(forecast) {\n      var forecastCurTime = getCurDatetime(localUtcOffset, forecast.date);\n      hourlyForecastList.append(getNewHourlyWeatherListItem(forecastCurTime.format('HH:mm'), forecast.tmp));\n    });\n    hourlyForecastList.closest('.scrollbar-macosx').scrollbar();\n\n    // Daily forecast\n    var dailyForecastList = cityPanel.find('.weekday-weather-list');\n    var dailyForecastData = weatherData.daily_forecast.slice(1);\n    dailyForecastList.empty();\n    dailyForecastData.forEach(function(forecast) {\n      var curWeekday = getCurDatetime(localUtcOffset, forecast.date).isoWeekday();\n      dailyForecastList.append(getNewDailyWeatherItem(\n        `周${zhWeekDays[curWeekday]}`,\n        forecast.cond.txt_d,\n        weatherIconClassNames[forecast.cond.code_d].day,\n        forecast.tmp.max,\n        forecast.tmp.min\n      ))\n    })\n\n  }).done(function() {\n    // style manipulating\n    resizeHourlyForecastList();\n    // Hide loading effect\n    hideLoading(cityPanel.find('.card-content'));\n  });\n\n}\n\nfunction initRankChart(dtmString) {\n  var option = {\n    tooltip : {\n        trigger: 'axis',\n        axisPointer : {\n            type : 'shadow'\n        }\n    },\n    grid: {\n        top: '5%',\n        bottom: '5%'\n    },\n    backgroundColor: '#404a59',\n    xAxis: {\n        type : 'value',\n        position: 'top',\n        axisLine: {lineStyle: {color: '#fff'}},\n        splitLine: {lineStyle:{type:'dashed'}},\n        axisLabel: {textStyle: {color: '#fff'}}\n    },\n    yAxis: {\n        type : 'category',\n        axisLine: {show: false},\n        axisLabel: {show: false},\n        axisTick: {show: false},\n        splitLine: {show: false},\n        data : [] // city names\n    },\n    dataZoom: [\n      {\n        type: 'inside',\n        yAxisIndex: [0],\n        startValue: 0,\n        endValue: 5,\n        zoomLock: true\n      },\n      {\n        type: 'slider',\n        yAxisIndex: [0],\n        startValue: 0,\n        endValue: 5,\n        zoomLock: true\n      }\n    ],\n    series : []\n  };\n  var seriesDataTemplate = {\n    name: '',\n    type: 'bar',\n    label: {\n      normal: {\n        show: true,\n        formatter: '{b}'\n      }\n    }\n    // data: []\n  };\n\n  var chart = echarts.init(document.getElementById('rank-chart'));\n  setChartSize(chart, 0.6);\n  chart.resize();\n\n  registerEchartResizeFuncton(chart);\n\n  chart.showLoading();\n  // AQHI Rank\n  var aqhiSeriesData = Object.assign({}, seriesDataTemplate);\n  aqhiSeriesData.name = 'AQHI';\n  aqhiSeriesData.data = [];\n  option.series.push(aqhiSeriesData);\n  $.getJSON('api/airquality/city_record', {\n    update_dtm: dtmString,\n    ordering: '-aqhi',\n    limit: 50,\n    fields: 'aqhi,city__name_cn'\n  }).done(function(data) {\n    var records = data.results;\n\n    records.forEach(function(record) {\n      option.yAxis.data.push(record.city.name_cn);\n      aqhiSeriesData.data.push(parsePollutantOrAqiValue('aqhi', record.aqhi));\n    });\n\n    option.dataZoom.forEach(function(dataZoomItem) {\n      dataZoomItem.startValue = records.length - 1;\n      dataZoomItem.endValue = Math.max(dataZoomItem.startValue - 5, 0);\n    });\n\n    chart.setOption(option);\n    chart.hideLoading();\n  });\n\n}\n\nfunction getCurDatetime(utcOffset, string) {\n  return moment(string).utcOffset(utcOffset).local();\n}\n\nfunction getNewHourlyWeatherListItem(time, temp) {\n  return $(`\n    <li class=\"hourly-weather-item halign-row\">\n      <div class=\"hourly-weather-time\">${time}</div>\n      <div class=\"hourly-weather-temp\"><span class=\"hourly-weather-temp-data\">${temp}</span>º</div>\n    </li>\n  `);\n}\n\nfunction getNewDailyWeatherItem(weekday, weatherText, weatherIconClass, maxTemp, minTemp) {\n  return $(`\n    <div class=\"row daily-weather-row\">\n      <div class=\"col-xs-3 daily-weather-weekday-col\">\n        <p class=\"card-text daily-weather-weekday-text\">${weekday}</p>\n      </div>\n      <div class=\"col-xs-6 daily-weather-descrip-col\">\n        <span class=\"daily-weather-descrip-text\">${weatherText}</span>\n        <i class=\"wi ${weatherIconClass}\"></i>\n      </div>\n      <div class=\"col-xs-3 daily-temp-range\">\n        <span class=\"daily-max-temp\">${maxTemp}</span>\n        <span class=\"daily-min-temp\">${minTemp}</span>\n      </div>\n    </div>\n  `)\n}\n\nfunction hideLoading(parent) {\n  var overlayEle = parent.find('.loading-overlay');\n  overlayEle.fadeOut('slow');\n  parent.removeClass('loading');\n}\n\nfunction showLoading(parent) {\n  var overlayEle = parent.find('.loading-overlay');\n  overlayEle.fadeIn('fast');\n  parent.addClass('loading');\n}\n\nfunction setChartSize(chart, ratio) {\n  var container = $(chart.getDom());\n  var containerWidth = container.width();\n  container.css({\n    width: containerWidth,\n    height: containerWidth * ratio\n  });\n}\n\nfunction registerEchartResizeFuncton(chart) {\n  function doneResizing(loadingParent) {\n    hideLoading(loadingParent);\n  }\n\n  var id;\n  $(window).on('resize', function() {\n    var container = $(chart.getDom());\n    var loadingParent = container.closest('.card-content');\n    container.width(0);\n    showLoading(loadingParent);\n\n    var width = container.closest('.card-block').width();\n    var heightToSet = width * 0.6;\n    container.width(width);\n    container.height(heightToSet);\n\n    chart.resize();\n\n    window.clearTimeout(id);\n    id = window.setTimeout(doneResizing.bind(this, loadingParent), 500);\n  });\n}\n\nfunction getAqhiLevel(indexString) {\n  var indexValue = parseFloat(indexString);\n  var level = 0;\n  for (let value of aqhiRange) {\n    if (indexValue < value)\n      break;\n    level += 1;\n  }\n  return level;\n}\n\nfunction parsePollutantOrAqiValue(name, valueString, decimalPlaces) {\n  decimalPlaces = typeof decimalPlaces !== 'undefined' ? decimalPlaces : 2;\n  if (['co', 'aqhi'].indexOf(name) == -1)\n    return parseInt(valueString);\n  else\n    return parseFloat(parseFloat(valueString).toFixed(decimalPlaces))\n}\n\nfunction getAqhiHtml(value) {\n  if (value <= 10 && value >= 1) {\n    return String(parseInt(value));\n  } else if (value == 11) {\n    return '10<sup>+</sup>';\n  } else if (value == '') {\n    return 'N/A'\n  }\n}"]}